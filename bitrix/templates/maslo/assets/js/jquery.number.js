!function(d){function p(t,e){if(this.createTextRange){var a=this.createTextRange();a.collapse(!0),a.moveStart("character",t),a.moveEnd("character",e),a.select()}else this.setSelectionRange&&(this.focus(),this.setSelectionRange(t,e))}function g(t){var e,a=d(this).val(),i=this.value.length;return t="start"==t.toLowerCase()?"Start":"End",this.createTextRange?((e=document.selection.createRange().duplicate())["move"+t]("character",-a.length),""==e.text&&(i=a.length),i=a.lastIndexOf(e.text)):void 0!==this["selection"+t]&&(i=this["selection"+t]),i}d.fn.number=function(t,u,o,h){h=void 0===h?",":h;var e="\\u"+("0000"+(o=void 0===o?".":o).charCodeAt(0).toString(16)).substr(-4),c=new RegExp("[^"+e+"0-9]","g"),v=new RegExp(e,"g");return!0===t?this.is("input:text")?this.on({"keydown.format":function(t){var e=d(this),a=e.data("numFormat"),i=t.keyCode?t.keyCode:t.which,n=unescape(t.originalEvent.keyIdentifier.replace("U+","%u")),s=g.apply(this,["start"]),l=g.apply(this,["end"]),r="";if(setPos=!1,8===i||n==o||!(i<48||57<i)||!(i<96||105<i)){if((0!=s||l!=this.value.length)&&0!=e.val()||t.metaKey||t.ctrlKey||t.altKey||1!==n.length||0==n?a.c=l-this.value.length:(s=l=1,this.value="",a.init=-1,a.c=-(u+1),p.apply(this,[0,0])),s==this.value.length-u-1&&n==o)a.c++,a.init=Math.max(0,a.init),t.preventDefault(),setPos=this.value.length+a.c;else if(n==o)a.init=Math.max(0,a.init),t.preventDefault();else if(8==i&&s==this.value.length-u)t.preventDefault(),a.c--,setPos=this.value.length+a.c;else if(8==i&&s>this.value.length-u){if(""===this.value)return;"0"!=this.value.substr(s-1,1)&&(r=this.value.substr(0,s-1)+"0"+this.value.substr(s),e.val(r.replace(c,"").replace(v,o))),t.preventDefault(),a.c--,setPos=this.value.length+a.c}else 8==i&&this.value.substr(s-1,1)==h?(t.preventDefault(),a.c--,setPos=this.value.length+a.c):s==l&&this.value.length>u+1&&s>this.value.length-u-1&&isFinite(+n)&&!t.metaKey&&!t.ctrlKey&&!t.altKey&&1===n.length&&(r=l===this.value.length?this.value.substr(0,s-1):this.value.substr(0,s)+this.value.substr(s+1),this.value=r,setPos=s);!1!==setPos&&p.apply(this,[setPos,setPos]),e.data("numFormat",a)}},"keyup.format":function(t){var e,a=d(this),i=a.data("numFormat"),n=t.keyCode?t.keyCode:t.which,s=g.apply(this,["start"]);""===this.value||(n<48||57<n)&&(n<96||105<n)&&8!==n||(a.val(a.val()),i.init<1?(s=this.value.length-u-(i.init<0?1:0),i.c=s-this.value.length,i.init=1,a.data("numFormat",i)):s>this.value.length-u&&8!=n&&(i.c++,a.data("numFormat",i)),e=this.value.length+i.c,p.apply(this,[e,e]))},"paste.format":function(t){var e=d(this),a=t.originalEvent,i=null;return window.clipboardData&&window.clipboardData.getData?i=window.clipboardData.getData("Text"):a.clipboardData&&a.clipboardData.getData&&(i=a.clipboardData.getData("text/plain")),e.val(i),t.preventDefault(),!1}}).each(function(){var t=d(this).data("numFormat",{c:-(u+1),decimals:u,thousands_sep:h,dec_point:o,regex_dec_num:c,regex_dec:v,init:!1});""!==this.value&&t.val(t.val())}):this.each(function(){var t=d(this),e=+t.text().replace(c,"").replace(v,".");t.number(isFinite(e)?+e:0,u,o,h)}):this.text(d.number.apply(window,arguments))};var i=null,n=null;d.valHooks.text?(i=d.valHooks.text.get,n=d.valHooks.text.set):d.valHooks.text={},d.valHooks.text.get=function(t){var e,a=d(t).data("numFormat");return a?""===t.value?"":(e=+t.value.replace(a.regex_dec_num,"").replace(a.regex_dec,a.dec_point),""+(isFinite(e)?e:0)):d.isFunction(i)?i(t):void 0},d.valHooks.text.set=function(t,e){var a=d(t).data("numFormat");return a?t.value=d.number(e,a.decimals,a.dec_point,a.thousands_sep):d.isFunction(n)?n(t,e):void 0},d.number=function(t,e,a,i){i=void 0===i?",":i,a=void 0===a?".":a,e=isFinite(+e)?Math.abs(e):0;var n="\\u"+("0000"+a.charCodeAt(0).toString(16)).substr(-4);t=(t+"").replace(new RegExp(n,"g"),".").replace(new RegExp("[^0-9+-Ee.]","g"),"");var s,l,r,u=isFinite(+t)?+t:0,o="";return 3<(o=(e?(s=u,l=e,r=Math.pow(10,l),""+Math.round(s*r)/r):""+Math.round(u)).split("."))[0].length&&(o[0]=o[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(o[1]||"").length<e&&(o[1]=o[1]||"",o[1]+=new Array(e-o[1].length+1).join("0")),o.join(a)}}(jQuery);